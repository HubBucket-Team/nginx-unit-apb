FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZTogbmdpbngtdW5pdC1hcGIKaW1hZ2U6IG5naW54aW5jL25naW54LXVuaXQtYXBiCmRlc2Ny\
aXB0aW9uOiBOR0lOWCBVbml0IGlzIGEgZHluYW1pYyBtdWx0aS1saW5ndWFsIGFwcGxpY2F0aW9u\
IHNlcnZlciBmb3IgbW9kZXJuIGRpc3RyaWJ1dGVkIGFwcGxpY2F0aW9ucy4KYmluZGFibGU6IGZh\
bHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwOi8v\
dW5pdC5uZ2lueC5vcmcvCiAgZGlzcGxheU5hbWU6IE5HSU5YIFVuaXQKICBpbWFnZVVybDogaHR0\
cHM6Ly9jZG4tMS53cC5uZ2lueC5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMTcvMDgvdW5pdC1n\
cmV5c2NhbGUtaWNvbi5wbmcKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlv\
bjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBOR0lOWCBVbml0CiAgICBmcmVlOiB0cnVlCiAg\
ICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogY29uZmlndXJhdGlv\
bgogICAgICAgIGRlZmF1bHQ6ICd7ImFwcGxpY2F0aW9ucyI6eyJleGFtcGxlX3BocCI6eyJ0eXBl\
IjoicGhwIiwid29ya2VycyI6Miwicm9vdCI6Ii9zcnYvc3JjIiwiaW5kZXgiOiJpbmRleC5waHAi\
fX0sImxpc3RlbmVycyI6eyIqOjgzMDAiOnsiYXBwbGljYXRpb24iOiJleGFtcGxlX3BocCJ9fX0n\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICB0aXRs\
ZTogTkdJTlggVW5pdCBKU09OIFBheWxvYWQKICAgICAgLSBuYW1lOiByZXBvc2l0b3J5CiAgICAg\
ICAgZGVmYXVsdDogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vN2JiMTYxZDI3MWI3MWUxMzljYjVl\
NjA2YjRmMWE0YjQuZ2l0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgICB0aXRsZTogR2l0IFJlcG9zaXRvcnkgVVJMCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
